<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SÁCH TIẾNG ANH III</title>
    <link rel="stylesheet" href="http://nghiquan.shop/nghiquan/reset.css">
    <link rel="stylesheet" href="/../TAII/css.css">
</head>

<body>
    <div class="main">
        <div class="header">
            <div class="header__page">1</div>
        </div>
        <div class="iframe">
            <iframe class="iframe__data--find"
                src="https://ebooks.helbling-ezone.com/ebook/books/jetstream-american-intermediate-wb-split-a-ebook-2021-4oDYyt6D70TYX3VDd1O8h90KNKjYoPTV/pages/svg/1.svg"
                frameborder="0">
            </iframe>
        </div>
        <div class="controller">
            <div class="controller__prev">&#8656;</div>
            <div class="controller__search">
                <input type="number" class="controller__search__input" value="1">
            </div>
            <div class="controller__next">&#8658;</div>
        </div>
    </div>

    <script>
        (function () {
            var controller = function () {
                var url = 'https://ebooks.helbling-ezone.com/ebook/books/jetstream-american-intermediate-wb-split-a-ebook-2021-4oDYyt6D70TYX3VDd1O8h90KNKjYoPTV/pages/svg/1.svg'
                var length = url.length
                var start = 1
                var end = 53
                var page = document.querySelector('.header__page')
                var controllerPrev = document.querySelector('.controller__prev')
                var controllerNext = document.querySelector('.controller__next')
                var controllerSearch = document.querySelector('.controller__search__input')
                var main = document.querySelector('.main')
                var iframe = document.querySelector('.iframe')
                var not = document.querySelectorAll(':not(.controller__search, .controller__search__input)')
                function getIndex() {
                    var i = iframe.querySelector('iframe')
                    var src = i.getAttribute('src')
                    var index = 1
                    if (src.length == length) {
                        index = src.slice(length - 5, length - 4)
                    }
                    if (src.length == length + 1) {
                        index = src.slice(length - 5, length - 3)
                    }

                    return Number(index)
                }

                controllerNext.onclick = function () {
                    if (getIndex() == end) {
                        return
                    }
                    var index = getIndex() + 1
                    renderIframe(index)
                }
                controllerPrev.onclick = function () {
                    if (getIndex() == start) {
                        return
                    }
                    var index = getIndex() - 1
                    renderIframe(index)
                }
                controllerSearch.addEventListener('click', function () {
                    var index = controllerSearch.value
                    renderIframe(index)
                })
                controllerSearch.addEventListener('change', function () {
                    var index = controllerSearch.value
                    renderIframe(index)
                })
                controllerSearch.addEventListener('input', function () {
                    var index = controllerSearch.value
                    renderIframe(index)
                })

                function renderIframe(index) {
                    if (index == '' || index == getIndex()) {
                        return
                    }
                    if (index < start || index > end) {
                        alert('Not Find Page: ' + index + '!\n Tài liệu có trang bắt đầu từ '+start+' đến '+end)
                        controllerSearch.value = page.textContent
                        return
                    }
                    iframe.innerHTML = `
                    <iframe
                        class="iframe__data--find"
                        src="https://ebooks.helbling-ezone.com/ebook/books/jetstream-american-intermediate-wb-split-a-ebook-2021-4oDYyt6D70TYX3VDd1O8h90KNKjYoPTV/pages/svg/${index}.svg"
                        frameborder="0">
                    </iframe>
                    `
                    page.innerHTML = index
                }

                not.forEach(function (item) {
                    this.onclick = function () {
                        clickNot()
                    }
                })

                function clickNot() {
                    controllerSearch.value = page.textContent
                }
            }

            controller()
        })()
    </script>
</body>

</html>